'use strict';

var express = require('express');
var path = require('path');
var bodyParser = require('body-parser');
var mongoose = require('mongoose');
var handlers = require('./handlers.js');
var session = require('express-session');
mongoose.Promise = require('bluebird');

mongoose.connect('mongodb://localhost/notelist');

var app = express();

app.use(session({ secret: 'secret', username: null, password: null, resave: true, saveUninitialized: true }));
app.use(bodyParser.json());
app.use(bodyParser.urlencoded({ extended: true }));

app.use('/', handlers.checkSession, express.static(path.join(__dirname, '../client'), { redirect: false }));
app.use('/lib', express.static(path.join(__dirname, '../../node_modules'), { redirect: false }));
app.use('/login', express.static(path.join(__dirname, '../client/pages/login.html'), { redirect: false }));
app.use('/logout', handlers.logout);
app.use('/signup', express.static(path.join(__dirname, '../client/pages/signup.html'), { redirect: false }));

app.get('/movies/search', handlers.fetchMovies);

app.post('/movies/users', handlers.checkUsers);
app.post('/signup', handlers.signup);
app.post('/login', handlers.login);
app.post('/movies/search', handlers.addMovie);

app.listen(8000);
console.log('Listening on 127.0.0.1:8000');

module.exports = app;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9zZXJ2ZXIvc2VydmVyLmpzIl0sIm5hbWVzIjpbImV4cHJlc3MiLCJyZXF1aXJlIiwicGF0aCIsImJvZHlQYXJzZXIiLCJtb25nb29zZSIsImhhbmRsZXJzIiwic2Vzc2lvbiIsIlByb21pc2UiLCJjb25uZWN0IiwiYXBwIiwidXNlIiwic2VjcmV0IiwidXNlcm5hbWUiLCJwYXNzd29yZCIsInJlc2F2ZSIsInNhdmVVbmluaXRpYWxpemVkIiwianNvbiIsInVybGVuY29kZWQiLCJleHRlbmRlZCIsImNoZWNrU2Vzc2lvbiIsInN0YXRpYyIsImpvaW4iLCJfX2Rpcm5hbWUiLCJyZWRpcmVjdCIsImxvZ291dCIsImdldCIsImZldGNoTW92aWVzIiwicG9zdCIsImNoZWNrVXNlcnMiLCJzaWdudXAiLCJsb2dpbiIsImFkZE1vdmllIiwibGlzdGVuIiwiY29uc29sZSIsImxvZyIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7O0FBQUEsSUFBSUEsVUFBVUMsUUFBUSxTQUFSLENBQWQ7QUFDQSxJQUFJQyxPQUFPRCxRQUFRLE1BQVIsQ0FBWDtBQUNBLElBQUlFLGFBQWFGLFFBQVEsYUFBUixDQUFqQjtBQUNBLElBQUlHLFdBQVdILFFBQVEsVUFBUixDQUFmO0FBQ0EsSUFBSUksV0FBV0osUUFBUSxlQUFSLENBQWY7QUFDQSxJQUFJSyxVQUFVTCxRQUFRLGlCQUFSLENBQWQ7QUFDQUcsU0FBU0csT0FBVCxHQUFtQk4sUUFBUSxVQUFSLENBQW5COztBQUVBRyxTQUFTSSxPQUFULENBQWlCLDhCQUFqQjs7QUFFQSxJQUFJQyxNQUFNVCxTQUFWOztBQUVBUyxJQUFJQyxHQUFKLENBQVFKLFFBQVEsRUFBQ0ssUUFBUSxRQUFULEVBQW1CQyxVQUFVLElBQTdCLEVBQW1DQyxVQUFVLElBQTdDLEVBQW1EQyxRQUFRLElBQTNELEVBQWlFQyxtQkFBbUIsSUFBcEYsRUFBUixDQUFSO0FBQ0FOLElBQUlDLEdBQUosQ0FBUVAsV0FBV2EsSUFBWCxFQUFSO0FBQ0FQLElBQUlDLEdBQUosQ0FBUVAsV0FBV2MsVUFBWCxDQUFzQixFQUFDQyxVQUFVLElBQVgsRUFBdEIsQ0FBUjs7QUFFQVQsSUFBSUMsR0FBSixDQUFRLEdBQVIsRUFBYUwsU0FBU2MsWUFBdEIsRUFBb0NuQixRQUFRb0IsTUFBUixDQUFlbEIsS0FBS21CLElBQUwsQ0FBVUMsU0FBVixFQUFxQixXQUFyQixDQUFmLEVBQWtELEVBQUNDLFVBQVUsS0FBWCxFQUFsRCxDQUFwQztBQUNBZCxJQUFJQyxHQUFKLENBQVEsTUFBUixFQUFnQlYsUUFBUW9CLE1BQVIsQ0FBZWxCLEtBQUttQixJQUFMLENBQVVDLFNBQVYsRUFBcUIsb0JBQXJCLENBQWYsRUFBMkQsRUFBQ0MsVUFBVSxLQUFYLEVBQTNELENBQWhCO0FBQ0FkLElBQUlDLEdBQUosQ0FBUSxRQUFSLEVBQWtCVixRQUFRb0IsTUFBUixDQUFlbEIsS0FBS21CLElBQUwsQ0FBVUMsU0FBVixFQUFxQiw0QkFBckIsQ0FBZixFQUFtRSxFQUFDQyxVQUFVLEtBQVgsRUFBbkUsQ0FBbEI7QUFDQWQsSUFBSUMsR0FBSixDQUFRLFNBQVIsRUFBbUJMLFNBQVNtQixNQUE1QjtBQUNBZixJQUFJQyxHQUFKLENBQVEsU0FBUixFQUFtQlYsUUFBUW9CLE1BQVIsQ0FBZWxCLEtBQUttQixJQUFMLENBQVVDLFNBQVYsRUFBcUIsNkJBQXJCLENBQWYsRUFBb0UsRUFBQ0MsVUFBVSxLQUFYLEVBQXBFLENBQW5COztBQUVBZCxJQUFJZ0IsR0FBSixDQUFRLGdCQUFSLEVBQTBCcEIsU0FBU3FCLFdBQW5DOztBQUdBakIsSUFBSWtCLElBQUosQ0FBUyxlQUFULEVBQTBCdEIsU0FBU3VCLFVBQW5DO0FBQ0FuQixJQUFJa0IsSUFBSixDQUFTLFNBQVQsRUFBb0J0QixTQUFTd0IsTUFBN0I7QUFDQXBCLElBQUlrQixJQUFKLENBQVMsUUFBVCxFQUFtQnRCLFNBQVN5QixLQUE1QjtBQUNBckIsSUFBSWtCLElBQUosQ0FBUyxnQkFBVCxFQUEyQnRCLFNBQVMwQixRQUFwQzs7QUFFQXRCLElBQUl1QixNQUFKLENBQVcsSUFBWDtBQUNBQyxRQUFRQyxHQUFSLENBQVksNkJBQVo7O0FBRUFDLE9BQU9DLE9BQVAsR0FBaUIzQixHQUFqQiIsImZpbGUiOiJzZXJ2ZXIuanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgZXhwcmVzcyA9IHJlcXVpcmUoJ2V4cHJlc3MnKTtcbnZhciBwYXRoID0gcmVxdWlyZSgncGF0aCcpO1xudmFyIGJvZHlQYXJzZXIgPSByZXF1aXJlKCdib2R5LXBhcnNlcicpO1xudmFyIG1vbmdvb3NlID0gcmVxdWlyZSgnbW9uZ29vc2UnKTtcbnZhciBoYW5kbGVycyA9IHJlcXVpcmUoJy4vaGFuZGxlcnMuanMnKTtcbnZhciBzZXNzaW9uID0gcmVxdWlyZSgnZXhwcmVzcy1zZXNzaW9uJyk7XG5tb25nb29zZS5Qcm9taXNlID0gcmVxdWlyZSgnYmx1ZWJpcmQnKTtcblxubW9uZ29vc2UuY29ubmVjdCgnbW9uZ29kYjovL2xvY2FsaG9zdC9ub3RlbGlzdCcpO1xuXG52YXIgYXBwID0gZXhwcmVzcygpO1xuXG5hcHAudXNlKHNlc3Npb24oe3NlY3JldDogJ3NlY3JldCcsIHVzZXJuYW1lOiBudWxsLCBwYXNzd29yZDogbnVsbCwgcmVzYXZlOiB0cnVlLCBzYXZlVW5pbml0aWFsaXplZDogdHJ1ZX0pKVxuYXBwLnVzZShib2R5UGFyc2VyLmpzb24oKSk7XG5hcHAudXNlKGJvZHlQYXJzZXIudXJsZW5jb2RlZCh7ZXh0ZW5kZWQ6IHRydWV9KSk7XG5cbmFwcC51c2UoJy8nLCBoYW5kbGVycy5jaGVja1Nlc3Npb24sIGV4cHJlc3Muc3RhdGljKHBhdGguam9pbihfX2Rpcm5hbWUsICcuLi9jbGllbnQnKSwge3JlZGlyZWN0OiBmYWxzZX0pKTtcbmFwcC51c2UoJy9saWInLCBleHByZXNzLnN0YXRpYyhwYXRoLmpvaW4oX19kaXJuYW1lLCAnLi4vLi4vbm9kZV9tb2R1bGVzJyksIHtyZWRpcmVjdDogZmFsc2V9KSk7XG5hcHAudXNlKCcvbG9naW4nLCBleHByZXNzLnN0YXRpYyhwYXRoLmpvaW4oX19kaXJuYW1lLCAnLi4vY2xpZW50L3BhZ2VzL2xvZ2luLmh0bWwnKSwge3JlZGlyZWN0OiBmYWxzZX0pKVxuYXBwLnVzZSgnL2xvZ291dCcsIGhhbmRsZXJzLmxvZ291dCk7XG5hcHAudXNlKCcvc2lnbnVwJywgZXhwcmVzcy5zdGF0aWMocGF0aC5qb2luKF9fZGlybmFtZSwgJy4uL2NsaWVudC9wYWdlcy9zaWdudXAuaHRtbCcpLCB7cmVkaXJlY3Q6IGZhbHNlfSkpXG5cbmFwcC5nZXQoJy9tb3ZpZXMvc2VhcmNoJywgaGFuZGxlcnMuZmV0Y2hNb3ZpZXMpO1xuXG5cbmFwcC5wb3N0KCcvbW92aWVzL3VzZXJzJywgaGFuZGxlcnMuY2hlY2tVc2Vycyk7XG5hcHAucG9zdCgnL3NpZ251cCcsIGhhbmRsZXJzLnNpZ251cCk7XG5hcHAucG9zdCgnL2xvZ2luJywgaGFuZGxlcnMubG9naW4pO1xuYXBwLnBvc3QoJy9tb3ZpZXMvc2VhcmNoJywgaGFuZGxlcnMuYWRkTW92aWUpO1xuXG5hcHAubGlzdGVuKDgwMDApO1xuY29uc29sZS5sb2coJ0xpc3RlbmluZyBvbiAxMjcuMC4wLjE6ODAwMCcpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGFwcDsiXX0=